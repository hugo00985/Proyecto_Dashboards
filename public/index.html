<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Dashboards · Sprint 2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./css/styles.css" />
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<header>
  <h1>Dashboards · Sprint 2</h1>
  <nav>
    <button class="tab-btn" data-tab="tab-procesos">Procesos</button>
    <button class="tab-btn" data-tab="tab-kpis">KPIs</button>
    <button class="tab-btn" data-tab="tab-analisis">Análisis</button>
  </nav>
</header>

<main>
  <!-- PROCESOS -->
  <section id="tab-procesos" class="tab active">
    <h2>Procesos</h2>
    <form id="form-proceso" class="card">
      <div class="grid">
        <label>Nombre <input name="nombre" required></label>
        <label>Responsable <input name="responsable"></label>
        <label>Fecha inicio <input type="date" name="fecha_inicio" required></label>
        <label>Fecha fin <input type="date" name="fecha_fin"></label>
        <label>Estado
          <select name="estado">
            <option value="activo">activo</option>
            <option value="pausado">pausado</option>
            <option value="finalizado">finalizado</option>
          </select>
        </label>
      </div>
      <label>Descripción
        <textarea name="descripcion" rows="2"></textarea>
      </label>
      <button type="submit">Crear proceso</button>
      <span id="msg-proceso" class="msg"></span>
    </form>

    <div class="card">
      <h3>Listado</h3>
      <table id="tabla-procesos">
        <thead>
          <tr><th>ID</th><th>Nombre</th><th>Responsable</th><th>Estado</th><th>Inicio</th><th>Fin</th><th>Acciones</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- KPIs -->
  <section id="tab-kpis" class="tab">
    <h2>KPIs</h2>
    <form id="form-kpi" class="card">
      <div class="grid">
        <label>Nombre <input name="nombre" required></label>
        <label>Proceso (id) <input name="id_proceso" type="number" required></label>
        <label>Valor actual <input name="valor_actual" type="number" step="0.01" value="0"></label>
        <label>Umbral min <input name="umbral_min" type="number" step="0.01"></label>
        <label>Umbral max <input name="umbral_max" type="number" step="0.01"></label>
      </div>
      <label>Descripción
        <textarea name="descripcion" rows="2"></textarea>
      </label>
      <button type="submit">Crear KPI</button>
      <span id="msg-kpi" class="msg"></span>
    </form>

    <div class="card">
      <h3>Listado</h3>
      <div class="filters">
        <label>Filtrar por proceso (id):
          <input id="filtro-kpi-proceso" type="number" placeholder="id_proceso" />
        </label>
        <button id="btn-filtrar-kpis">Aplicar</button>
        <button id="btn-limpiar-kpis" class="secondary">Limpiar</button>
      </div>
      <table id="tabla-kpis">
        <thead>
          <tr><th>ID</th><th>Nombre</th><th>Proceso</th><th>Valor</th><th>Umbral min</th><th>Umbral max</th><th>Acciones</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- ANALISIS -->
  <section id="tab-analisis" class="tab">
    <h2>Análisis de evolución</h2>
    <form id="form-analisis" class="card">
      <div class="grid">
        <label>Desde <input type="date" name="desde" required></label>
        <label>Hasta <input type="date" name="hasta" required></label>
        <label>KPI
          <select name="kpi">
            <option value="ventas_totales" selected>ventas_totales</option>
          </select>
        </label>
      </div>
      <button type="submit">Generar</button>
      <span id="msg-analisis" class="msg"></span>
    </form>

    <div class="card">
      <canvas id="chart-evolucion" height="120"></canvas>
    </div>

    <div class="card">
      <h3>Datos</h3>
      <table id="tabla-evolucion">
        <thead><tr><th>Fecha</th><th>Valor</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
<div class="card">
  <div style="display:flex; gap:8px; align-items:center; justify-content:flex-end; margin-bottom:8px">
    <button id="btn-export-csv" class="secondary">Exportar CSV</button>
    <button id="btn-export-excel">Exportar Excel</button>
  </div>
  <canvas id="chart-evolucion" height="120"></canvas>
</div>

  </section>
</main>

<footer>
  <small>Los Socios · Sprint 2</small>
</footer>

<script src="./js/api.js"></script>
<script src="./js/dashboard.js"></script>
</body>
</html>
